import{M as b,P as j,r as o,j as e,I as y,K as p}from"./index-BfV2x0pX.js";const S=async r=>await b({path:"/slots/book",method:j,data:r}),N=async r=>await b({path:"/slots/release",method:j,data:r}),v={bookSlot:S,releaseSlot:N},k=({onSelect:r})=>{const[i,c]=o.useState([]),[x,l]=o.useState(""),[u,n]=o.useState([]);o.useEffect(()=>{(async()=>{try{const t=await b({path:"/users"});c(t.data)}catch(t){console.error("Error fetching users:",t)}})()},[]);const h=a=>{const t=a.target.value;l(t),t.length>=3?n(i.filter(m=>m.name.toLowerCase().includes(t.toLowerCase()))):n([])},g=a=>{r(a),l(""),n([])};return e.jsxs("div",{children:[e.jsx("input",{name:"user",type:"text",value:x,onChange:h,placeholder:"Search Employees...",className:"w-full p-2 border border-gray-300 rounded"}),x.length>=3&&e.jsx("div",{className:"absolute  bg-green-300 border border-gray-300 rounded shadow-lg sm:w-2/6",children:e.jsx("ul",{className:"list-disc pl-5",children:u.map(a=>e.jsx("li",{onClick:()=>g(a),className:"py-1 cursor-pointer",children:a.name},a._id))})})]})},I=()=>{const[r,i]=o.useState(""),[c,x]=o.useState(""),[l,u]=o.useState([]),{data:n}=y(s=>s==null?void 0:s.user),h=Array.from({length:4},(s,d)=>d+1),g=async()=>{if(n.role==="admin"&&!t){p.error("Please select an user");return}if(!r||!c){p.error("Please enter both tower and date");return}try{const{data:s,success:d}=await b({path:`slots?tower=${r}&date=${c}`,method:"GET"});console.log("data",s),d&&u(s)}catch{p.error("Failed to fetch slots")}},a=async s=>{const d={tower:s.tower,slotId:s.slotId,date:c};n.role==="admin"&&(d.userId=t==null?void 0:t._id);const f=await v.bookSlot(d);f.success&&(p.success(f.message),u([]),m(void 0))},[t,m]=o.useState(),w=s=>{console.log(t),m(s)};return e.jsxs("div",{className:"container mx-auto p-4 max-w-xl mt-10 md:mt-6 lg:mt-12",children:[n.role==="admin"&&e.jsxs("div",{className:"",children:[e.jsx("h1",{className:"text-2xl mb-2",children:"Reserve Parking slot for Employees"}),e.jsx(k,{onSelect:w})," ",e.jsx("br",{}),t&&e.jsxs("p",{className:"text-start p-2",children:[e.jsxs("strong",{children:["Selected User",e.jsx("span",{className:"text-red-500",children:"*"}),": "]}),e.jsx("span",{className:"p-2 bg-purple-400 text-white",children:t==null?void 0:t.name})]})]}),e.jsxs("div",{className:"flex flex-wrap -mx-3 mb-6 mt-4",children:[e.jsxs("div",{className:"w-full md:w-1/2 px-3 mb-6 md:mb-0",children:[e.jsxs("label",{className:"block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2",htmlFor:"tower",children:["Tower",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{id:"tower",value:r,onChange:s=>i(s.target.value),className:"appearance-none block w-full bg-gray-200 text-gray-700 border border-sky-400 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white",children:[e.jsx("option",{value:"",children:"Select tower number"}),h==null?void 0:h.map(s=>e.jsxs("option",{value:s,children:["Tower ",s]},s))]})]}),e.jsxs("div",{className:"w-full md:w-1/2 px-3",children:[e.jsxs("label",{className:"block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2",htmlFor:"date",children:["Date",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",id:"date",value:c,onChange:s=>x(s.target.value),min:new Date().toISOString().split("T")[0],className:"appearance-none block w-full bg-gray-200 text-gray-700 border border-sky-400 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-gray-500"})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:g,className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",children:"Search"})}),(l==null?void 0:l.length)>0&&e.jsx("div",{className:"mt-6",children:e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-6 border-b text-left",children:"Slot ID"})," ",e.jsx("th",{className:"py-2 px-6 border-b text-left",children:"Action"})," "]})}),e.jsx("tbody",{children:l==null?void 0:l.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-6 border-b text-left",children:s==null?void 0:s.slotId})," ",e.jsxs("td",{className:"py-2 px-6 border-b text-left",children:[" ",e.jsx("button",{onClick:()=>a(s),className:"bg-green-500 hover:bg-green-700 text-white font-bold py-1 px-3 rounded focus:outline-none focus:shadow-outline",children:"Book"})]})]},s==null?void 0:s.slotId))})]})})]})};export{I as default};
